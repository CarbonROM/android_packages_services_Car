<?xml version="1.0" encoding="utf-8"?>
<!--
  ~ Copyright (C) 2019 The Android Open Source Project
  ~
  ~ Licensed under the Apache License, Version 2.0 (the "License");
  ~ you may not use this file except in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~      http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License
  -->
<!-- System packages to preinstall on all automotive devices, per user type.
     OEMs must provide they own as well, listing their specific apps (like launcher, settings, etc...)
     Documentation at frameworks/base/data/etc/preinstalled-packages-platform.xml
-->
<config>
<!--
  Here the apps will have SYSTEM only.
-->
    <install-in-user-type package="com.android.experimentalcar">
        <install-in user-type="SYSTEM" />
    </install-in-user-type>

<!--
  Apps that need to run on SYSTEM and evaluated by package owner.
  Here the apps will have FULL and SYSTEM.
-->
    <install-in-user-type package="android">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="android.car.cluster">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.car">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.car.frameworkpackagestubs">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>

    <!-- Needed for Projected on Embedded so it receives LOCKED_BOOT_COMPLETED immediately, 
      otherwise projection wouldn't launch on startup-->
    <install-in-user-type package="android.car.usb.handler">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>

    <!-- Need to upload collected bugreports even if the user (u10) was deleted or changed. -->
    <install-in-user-type package="com.android.car.bugreport">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>

    <!-- Not sure, leave for security purpose. -->
    <install-in-user-type package="com.android.keychain">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>

    <!-- Mainline Wi-fi stack, it's needed for all users -->
    <install-in-user-type package="com.android.wifi">
        <install-in user-type="SYSTEM" />
        <install-in user-type="FULL" />
    </install-in-user-type>

    <!-- Provices Settings. Secure for SYSTEM, which are used in places such as SUW -->
    <install-in-user-type package="com.android.providers.settings">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>

    <!--
      CompanionDeviceSupport app needs to run on SYSTEM for the Trusted Device feature to work.
      It needs to run in the foreground user for other companion app features like calendar sync
      and notifications bridging
    -->
    <install-in-user-type package="com.android.car.companiondevicesupport">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>

<!--
  Apps that do need to run on SYSTEM and evaluated by package owner.
  Here the apps will have FULL only.
-->
    <install-in-user-type package="com.android.htmlviewer">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.protips">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.inputdevices">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.soundpicker">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.captiveportallogin">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.google.android.car.hideapps">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.stk">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.dreams.phototable">
        <install-in user-type="FULL" />
    </install-in-user-type>

    <!-- TODO(b/146892902): comment why is needed or remove -->
    <install-in-user-type package="com.android.carrierdefaultapp">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.soundrecorder">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.bips">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.settings.intelligence">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.egg">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.bookmarkprovider">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.simappdialog">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.dreams.basic">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.companiondevicemanager">
        <install-in user-type="FULL" />
    </install-in-user-type>

<!--
  Apps that may run on SYSTEM. Some criteria:
  - Require INTERACT_ACROSS_USER/INTERACT_ACROSS_USER_FULL
  - When system switchs to FULL user they're not killed by AM
  - (more to be added..)

  Here the apps will have FULL and SYSTEM for now,
  and they need to be evaluated and be moved to above sections.
-->
    <!-- Not sure, leave for security purpose. -->
    <install-in-user-type package="com.android.se">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>

    <!-- TODO(b/146892630): comment why is needed or remove -->
    <install-in-user-type package="com.android.location.fused">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.bluetooth">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.cellbroadcastreceiver">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.networkstack">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.networkstack.permissionconfig">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.ons">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.providers.telephony">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.providers.userdictionary">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.server.telecom">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.shell">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.storagemanager">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="android.auto_generated_rro_product__">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="android.auto_generated_rro_vendor__">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="android.autoinstalls.config.google.car">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.carrierconfig">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.certinstaller">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.cts.ctsshim">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.cts.priv.ctsshim">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.pacprocessor">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.proxyhandler">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.vpndialogs">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.server.backup.encryption">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.sharedstoragebackup">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>
    <install-in-user-type package="com.android.externalstorage">
        <install-in user-type="FULL" />
        <install-in user-type="SYSTEM" />
    </install-in-user-type>

<!--
  Apps that may/may not run on SYSTEM. Some criteria:
  - Do not require INTERACT_ACROSS_USER/INTERACT_ACROSS_USER_FULL
  - When system switchs to FULL user they're not killed by AM
  - Cause crush / test failure without SYSTEM
  - (more to be added..)

  Here the apps will have FULL for now,
  but they might be moved to first section if necessary.
-->
    <install-in-user-type package="com.android.bluetoothmidiservice">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.smspush">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.statementservice">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.backupconfirm">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.calllogbackup">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.providers.blockednumber">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.providers.calendar">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.providers.contacts">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.providers.downloads">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.providers.downloads.ui">
        <install-in user-type="FULL" />
    </install-in-user-type>
    <install-in-user-type package="com.android.providers.media">
        <install-in user-type="FULL" />
    </install-in-user-type>
</config>
